# 1.1 信号模型的数学表达

## 引言

在开始学习任何降噪算法之前，我们必须首先建立清晰的数学模型。这不仅是理论推导的基础，更是理解后续所有算法设计动机的关键。

---

## 1.1.1 加性噪声模型

语音降噪问题最基本的假设是**加性噪声模型(Additive Noise Model)**：

$$y(t) = s(t) + n(t)$$

其中：
- $y(t)$：带噪语音信号（观测信号）
- $s(t)$：纯净语音信号（目标信号）
- $n(t)$：噪声信号（干扰信号）
- $t$：时间索引

### 为什么是加性模型？

这个模型看似简单，但它背后有深刻的物理意义：

1. **声波叠加原理**：在空气中传播的声波遵循线性叠加原理，多个声源产生的声压可以直接相加。

2. **麦克风采集特性**：麦克风将声压转换为电信号，这个过程在正常工作范围内是线性的。

3. **数字化过程**：ADC（模数转换）也是线性操作。

### 模型的局限性

实际场景中，加性模型并不总是成立：

```
实际情况：y(t) = h(t) * s(t) + n(t) + 非线性失真
```

- **卷积噪声**：房间混响使语音信号与房间冲激响应 $h(t)$ 卷积
- **乘性噪声**：某些场景下噪声与信号相关
- **非线性失真**：设备饱和、削波等

但在大多数语音增强研究中，我们仍采用加性模型作为起点，因为：
1. 它足够简单，便于分析
2. 它能覆盖大部分实际场景
3. 更复杂的模型可以在此基础上扩展

---

## 1.1.2 时域 vs 频域表示

### 时域处理

直接在时域处理信号：

```
输入：y[n] = s[n] + n[n]，n = 0, 1, 2, ...
输出：ŝ[n]（估计的纯净语音）
```

**优点**：
- 无需变换，计算直接
- 避免频域变换带来的延迟
- 保留完整的相位信息

**缺点**：
- 语音和噪声在时域高度混叠
- 难以利用语音的频域结构特性
- 传统方法难以设计有效的时域滤波器

### 频域处理

将信号变换到频域后处理：

```
时域信号 → FFT → 频域处理 → IFFT → 时域信号
```

**优点**：
- 语音能量集中在特定频带，便于分离
- 可以利用语音的谐波结构
- 频域滤波等价于时域卷积，但计算更高效

**缺点**：
- 引入变换延迟（帧长 + 帧移）
- 相位处理困难
- 频谱泄漏问题

### 工程选择

**绝大多数语音增强系统选择频域处理**，原因：

1. 人耳对频率的感知是非线性的（听觉滤波器组）
2. 语音的产生机制（声道共振）在频域有清晰的物理解释
3. 噪声估计在频域更容易实现

---

## 1.1.3 短时傅里叶变换(STFT)：语音处理的基石

### 为什么不直接用FFT？

语音信号是**非平稳信号**——其统计特性随时间变化：

- 元音段：准周期信号，有明显的基频和谐波
- 辅音段：类噪声信号，能量分布广泛
- 静音段：低能量，接近背景噪声

对整段语音做FFT会丢失时变信息，无法区分不同语音段的特性。

### STFT的核心思想

**短时平稳假设**：在足够短的时间窗内（10-30ms），语音信号可以近似认为是平稳的。

STFT的定义：

$$Y(m, k) = \sum_{n=0}^{N-1} y(n + mH) \cdot w(n) \cdot e^{-j\frac{2\pi kn}{N}}$$

其中：
- $m$：帧索引
- $k$：频率索引（频点）
- $N$：FFT点数（通常256或512）
- $H$：帧移（Hop Size），通常为 $N/4$ 或 $N/2$
- $w(n)$：窗函数

### 参数选择的工程考量

#### 帧长(Frame Length)

```
帧长 = N / fs（秒）
```

- **太短**（<10ms）：频率分辨率差，无法分辨相邻谐波
- **太长**（>40ms）：时间分辨率差，无法跟踪快速变化
- **典型值**：20-32ms（对于16kHz采样率，即320-512点）

#### 帧移(Hop Size)

```
帧移 = H / fs（秒）
重叠率 = 1 - H/N
```

- **帧移小**：时间分辨率高，但计算量大
- **帧移大**：计算量小，但可能丢失瞬态信息
- **典型值**：帧长的25%-50%（75%-50%重叠）

#### 窗函数(Window Function)

常用窗函数及其特性：

| 窗函数 | 主瓣宽度 | 旁瓣衰减 | 应用场景 |
|--------|----------|----------|----------|
| 矩形窗 | 最窄 | -13dB | 几乎不用 |
| 汉宁窗(Hann) | 中等 | -31dB | 最常用 |
| 汉明窗(Hamming) | 中等 | -43dB | 语音分析 |
| 布莱克曼窗 | 较宽 | -58dB | 高动态范围 |

**为什么汉宁窗最常用？**

1. 满足COLA(Constant Overlap-Add)条件，保证完美重建
2. 旁瓣衰减足够，频谱泄漏可接受
3. 计算简单

### STFT的输出：时频表示

对于一段语音，STFT输出一个**复数矩阵**：

```
Y ∈ ℂ^(T × F)

T = 帧数 = (信号长度 - N) / H + 1
F = 频点数 = N/2 + 1（实信号的对称性）
```

每个元素 $Y(m,k)$ 是一个复数，包含：
- **幅度(Magnitude)**：$|Y(m,k)|$，表示该时频点的能量
- **相位(Phase)**：$\angle Y(m,k)$，表示该时频点的相位

### 频域加性模型

在STFT域，加性噪声模型变为：

$$Y(m,k) = S(m,k) + N(m,k)$$

这是频域降噪算法的起点。

---

## 1.1.4 逆STFT与信号重建

### 重叠相加法(Overlap-Add, OLA)

从STFT系数重建时域信号：

$$\hat{y}(n) = \frac{\sum_m \hat{y}_m(n-mH) \cdot w(n-mH)}{\sum_m w^2(n-mH)}$$

### 完美重建条件

为了保证 $\hat{y}(n) = y(n)$，需要满足COLA条件：

$$\sum_m w(n - mH) = \text{常数}$$

对于汉宁窗，当 $H = N/4$ 时，满足COLA条件。

### 相位的重要性

早期很多方法只处理幅度谱，使用带噪信号的相位重建：

$$\hat{S}(m,k) = |\hat{S}(m,k)| \cdot e^{j\angle Y(m,k)}$$

这种做法的问题：
- 低SNR时，带噪相位与纯净相位差异大
- 相位失真会导致语音质量下降

**现代方法（包括GTCRN）越来越重视相位的处理**，这是后续章节的重要内容。

---

## 1.1.5 从连续到离散：采样与量化

### 采样定理

语音信号的带宽通常在4kHz（电话）到8kHz（宽带）：

```
采样率 ≥ 2 × 最高频率

电话语音：8kHz采样率
宽带语音：16kHz采样率
全带语音：48kHz采样率
```

### 量化

现代系统通常使用16位或32位浮点量化：

```
16位整数：动态范围 ≈ 96dB
32位浮点：动态范围 > 120dB
```

---

## 本节小结

| 概念 | 要点 |
|------|------|
| 加性噪声模型 | $y(t) = s(t) + n(t)$，是所有降噪算法的起点 |
| 时域 vs 频域 | 频域处理是主流，因为语音特性在频域更明显 |
| STFT | 短时平稳假设，将非平稳信号转换为时频表示 |
| 参数选择 | 帧长20-32ms，帧移25%-50%，汉宁窗 |
| 相位问题 | 现代方法越来越重视相位处理 |

---

## 思考题

1. 为什么语音增强通常在频域而不是时域进行？从信号特性和计算效率两个角度分析。

2. 如果帧长设置为5ms，会出现什么问题？如果设置为100ms呢？

3. STFT的帧移设置会如何影响实时系统的延迟？

4. 为什么说相位处理是语音增强的难点？

---

## 延伸阅读

- Oppenheim, A. V., & Schafer, R. W. "Discrete-Time Signal Processing"
- Loizou, P. C. "Speech Enhancement: Theory and Practice" - Chapter 3
