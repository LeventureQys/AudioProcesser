# 前言

本文还是前置知识

### 双线性变换法

双线性变换法（Bilinear Transform）是一种用于将模拟滤波器转换为数字滤波器的方法。它通过将模拟域中的s平面上的传递函数映射到数字域中的z平面上的传递函数来实现这一转换。双线性变换法保证了频率响应在转换过程中不会产生混叠，并且在设计IIR滤波器时非常常用。

### 双线性变换的基本原理

双线性变换通过以下关系将s平面的传递函数转换为z平面的传递函数：

$$
s = \frac{2}{T} \cdot \frac{1 - z^{-1}}{1 + z^{-1}}
$$

其中：

- $s$ 是模拟域的复数频率变量。
- $z$ 是数字域的复数频率变量。
- $T$ 是采样周期。

这个公式将s平面的每一点双线性映射到z平面的一个点上，并且这种映射是保角的，即保持了角度关系。

双线性变换是一种用于将连续时间系统的频域表示（通常用拉普拉斯变换表示）转换为离散时间系统频域表示（通常用Z变换表示）的方法。这种转换特别有用，因为它允许我们将连续时间滤波器的设计（模拟滤波器）转化为离散时间滤波器的设计（数字滤波器），以便在数字信号处理（DSP）系统中实现。

作用：

双线性变换是将连续时间系统（模拟信号）的频域表示转换为离散时间系统（数字信号）频域表示的一种方法。通过这种变换，我们可以设计数字滤波器，使其频率响应与对应的模拟滤波器尽可能匹配。

### 转换过程

1. **模拟传递函数**：
   首先，从模拟滤波器的设计得到其传递函数 $H(s)$。
2. **应用双线性变换**：
   使用双线性变换公式，将 $s$ 替换为 $\frac{2}{T} \cdot \frac{1 - z^{-1}}{1 + z^{-1}}$，得到数字域的传递函数 $H(z)$。
3. **化简传递函数**：
   将得到的 $H(z)$ 化简为标准形式，通常表示为两个多项式的比值。

### 例子

假设我们有一个一阶低通模拟滤波器，其传递函数为：

$$
H(s) = \frac{\omega_c}{s + \omega_c}
$$

其中，$\omega_c$ 是截止角频率。

#### 步骤1：应用双线性变换

使用双线性变换公式，将 $s$ 替换为 $\frac{2}{T} \cdot \frac{1 - z^{-1}}{1 + z^{-1}}$：

$$
H(z) = \frac{\omega_c}{\frac{2}{T} \cdot \frac{1 - z^{-1}}{1 + z^{-1}} + \omega_c}
$$

#### 步骤2：化简传递函数

进行化简：

$$
H(z) = \frac{\omega_c (1 + z^{-1})}{\frac{2}{T} (1 - z^{-1}) + \omega_c (1 + z^{-1})}
$$

$$
H(z) = \frac{\omega_c (1 + z^{-1})}{\frac{2}{T} - \frac{2}{T} z^{-1} + \omega_c + \omega_c z^{-1}}
$$

$$
H(z) = \frac{\omega_c (1 + z^{-1})}{\left( \frac{2}{T} + \omega_c \right) + \left( \omega_c - \frac{2}{T} \right) z^{-1}}
$$

最后将分子和分母乘以 $T/2$ 进行化简：

$$
H(z) = \frac{\frac{\omega_c T}{2} (1 + z^{-1})}{1 + \left( \frac{\omega_c T - 2}{\omega_c T + 2} \right) z^{-1}}
$$

这就是数字滤波器的传递函数。

# z变换的意义和使用方法

## 什么是z变换

z变换是一种用于分析和处理离散时间信号和系统的重要工具。它将离散时间信号从时间域转换到复频域，从而简化了信号和系统的分析。z变换的定义如下：

$$
X(z) = \sum_{n=-\infty}^{\infty} x[n] z^{-n}
$$

其中：

- $X(z)$ 是信号 $x[n]$ 的z变换。
- $x[n]$ 是离散时间信号。
- $z$ 是复频域变量，通常表示为 $z = re^{j\omega}$，其中 $r$ 是幅度，$\omega$ 是频率。

## z变换的意义

1. **频域分析**：
   z变换将离散时间信号转换到频域，这使得频率响应和滤波器设计变得更加直观和简便。
2. **系统稳定性分析**：
   z变换用于确定离散时间系统的稳定性。系统的极点和零点位置可以直接从z变换的传递函数中获得，系统的稳定性可以通过检查极点是否位于单位圆内来确定。
3. **差分方程求解**：
   z变换可以将复杂的差分方程转换为代数方程，简化了求解过程。
4. **卷积计算**：
   在时间域中的卷积运算在z域中变为简单的乘法运算，这大大简化了计算过程。

## z变换的使用方法

1. **定义信号和系统**：
   首先，定义需要分析的离散时间信号或系统的差分方程。
2. **计算z变换**：
   对信号或系统方程进行z变换，得到其z域表示。
3. **极点-零点分析**：
   通过z变换的传递函数，分析系统的极点和零点位置，评估系统的频率响应和稳定性。
4. **求解差分方程**：
   使用z变换将差分方程转换为代数方程，然后求解该代数方程，再通过逆z变换回到时间域。

## z变换的性质

z变换有许多重要的性质，这些性质在信号处理和系统分析中非常有用。以下是一些主要的z变换性质：

## 1. 线性性质

如果 $x_1[n]$ 的z变换为 $X_1(z)$，$x_2[n]$ 的z变换为 $X_2(z)$，则：

$$
a x_1[n] + b x_2[n] \xrightarrow{\mathcal{Z}} a X_1(z) + b X_2(z)
$$

其中 $a$ 和 $b$ 是常数。

## 2. 移位性质

### 正向移位

如果 $x[n]$ 的z变换为 $X(z)$，则 $x[n-k]$ 的z变换为：

$$
x[n-k] \xrightarrow{\mathcal{Z}} z^{-k} X(z)
$$

### 反向移位

如果 $x[n]$ 的z变换为 $X(z)$，则 $x[n+k]$ 的z变换为：

$$
x[n+k] \xrightarrow{\mathcal{Z}} z^k (X(z) - \sum_{i=0}^{k-1} x[i] z^{-i})
$$

## 3. 乘以指数序列

如果 $x[n]$ 的z变换为 $X(z)$，则 $a^n x[n]$ 的z变换为：

$$
a^n x[n] \xrightarrow{\mathcal{Z}} X\left(\frac{z}{a}\right)
$$

## 4. 时间反转

如果 $x[n]$ 的z变换为 $X(z)$，则 $x[-n]$ 的z变换为：

$$
x[-n] \xrightarrow{\mathcal{Z}} X\left(\frac{1}{z}\right)
$$

## 5. 差分性质

如果 $x[n]$ 的z变换为 $X(z)$，则 $x[n]$ 的差分 $x[n]-x[n-1]$ 的z变换为：

$$
x[n] - x[n-1] \xrightarrow{\mathcal{Z}} (1 - z^{-1}) X(z)
$$

## 6. 累加性质

如果 $x[n]$ 的z变换为 $X(z)$，则 $y[n] = \sum_{k=-\infty}^{n} x[k]$ 的z变换为：

$$
y[n] = \sum_{k=-\infty}^{n} x[k] \xrightarrow{\mathcal{Z}} \frac{X(z)}{1 - z^{-1}}, \quad |z| > 1
$$

## 7. 卷积性质

如果 $x_1[n]$ 的z变换为 $X_1(z)$，$x_2[n]$ 的z变换为 $X_2(z)$，则 $y[n] = x_1[n] * x_2[n]$ 的z变换为：

$$
y[n] = x_1[n] * x_2[n] \xrightarrow{\mathcal{Z}} X_1(z) X_2(z)
$$

## 8. 初值定理

如果 $x[n]$ 的z变换为 $X(z)$，则：

$$
x[0] = \lim_{z \to \infty} X(z)
$$

## 9. 终值定理

如果 $x[n]$ 的z变换为 $X(z)$ 并且序列 $x[n]$ 收敛，则：

$$
\lim_{n \to \infty} x[n] = \lim_{z \to 1} (1 - z^{-1}) X(z)
$$

## 总结

z变换的这些性质在信号处理和系统分析中非常有用。它们不仅简化了计算，还提供了直观的理解和分析工具，使得处理离散时间信号和系统更加高效。

## 示例

考虑一个简单的差分方程：

$$
y[n] - 0.5y[n-1] = x[n]
$$

### 第一步：计算z变换

对方程两边进行z变换：

$$
Y(z) - 0.5z^{-1}Y(z) = X(z)
$$

### 第二步：求解z域方程

将方程中的 $Y(z)$ 提出来：

$$
Y(z)(1 - 0.5z^{-1}) = X(z)
$$

解得：

$$
H(z) = \frac{Y(z)}{X(z)} = \frac{1}{1 - 0.5z^{-1}}
$$

### 第三步：极点分析

传递函数 $H(z)$ 的极点在 $z = 0.5$。因为极点在单位圆内，所以系统是稳定的。

## 总结

z变换是分析和处理离散时间信号和系统的强大工具。它简化了频域分析、系统稳定性分析、差分方程求解和卷积计算，使得信号处理和滤波器设计更加直观和高效。