# 前言

如果想要看懂这一章，可能需要以下前置知识。。
[[信号与系统]傅里叶变换、卷积定理、和为什么时域的卷积等于频域相乘。](https://blog.csdn.net/Andius/article/details/139841656?spm=1001.2014.3001.5502)

[[信号与系统]有关滤波器的一些知识背景](https://blog.csdn.net/Andius/article/details/139848523?spm=1001.2014.3001.5502)

[[信号与系统]关于LTI系统的转换方程、拉普拉斯变换和z变换](https://blog.csdn.net/Andius/article/details/139851289?spm=1001.2014.3001.5502)

[[信号与系统]关于双线性变换](https://blog.csdn.net/Andius/article/details/139853924?spm=1001.2014.3001.5502)

[[信号与系统]模拟域中的一阶低通滤波器和二阶滤波器](https://blog.csdn.net/Andius/article/details/139860807?spm=1001.2014.3001.5502)

# 一阶IIR滤波器参数推导

一阶IIR（Infinite Impulse Response）滤波器是一种常见的数字滤波器，它具有无限的冲激响应。以下是推导一阶IIR低通滤波器参数的过程：

## 1. 数字滤波器的差分方程

一阶IIR滤波器的差分方程通常表示为：

$$
y[n] = b_0 x[n] + b_1 x[n-1] - a_1 y[n-1]
$$

其中：

- $y[n]$ 是当前输出
- $x[n]$ 是当前输入
- $b_0, b_1$ 是滤波器的系数
- $a_1$ 是滤波器的反馈系数

## 2. 频域分析

要推导这些系数，可以从滤波器的频率响应出发。数字滤波器的传递函数通常表示为：

$$
H(z) = \frac{Y(z)}{X(z)} = \frac{b_0 + b_1 z^{-1}}{1 + a_1 z^{-1}}
$$

## 3. 设计规范

假设我们要设计一个低通滤波器，给定一个截止频率 $\omega_c$，可以通过双线性变换将模拟滤波器转换为数字滤波器。

## 4. 双线性变换

模拟域中的一阶低通滤波器可以表示为：

$$
H(s) = \frac{1}{s + \omega_c}
$$

通过双线性变换 $s = \frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}}$，将模拟滤波器转换为数字滤波器。其中，$T$ 是采样周期。

将 $s = \frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}}$ 代入模拟滤波器的传递函数：

$$
H(s) = \frac{1}{\frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}} + \omega_c}
$$

## 5. 简化表达式

简化并重新排列上式，可以得到：

$$
H(z) = \frac{1 + z^{-1}}{(1 + z^{-1}) + \frac{\omega_c T}{2} (1 - z^{-1})}
$$

$$
H(z) = \frac{1 + z^{-1}}{1 + \frac{\omega_c T}{2} + z^{-1} (1 - \frac{\omega_c T}{2})}
$$

通过比较分子和分母的系数，可以确定滤波器的系数：

$$
b_0 = \frac{1}{1 + \frac{\omega_c T}{2}}
$$

$$
b_1 = \frac{1}{1 + \frac{\omega_c T}{2}}
$$

$$
a_1 = \frac{1 - \frac{\omega_c T}{2}}{1 + \frac{\omega_c T}{2}}
$$

## 6. 参数具体化

为了简化，我们可以用一些代数变换来将这些系数具体化：

$$
\alpha = \frac{\omega_c T}{2}
$$

于是：

$$
b_0 = \frac{1}{1 + \alpha}
$$

$$
b_1 = \frac{1}{1 + \alpha}
$$

$$
a_1 = \frac{1 - \alpha}{1 + \alpha}
$$

## 总结

一阶IIR低通滤波器的最终差分方程可以表示为：

$$
y[n] = b_0 x[n] + b_1 x[n-1] - a_1 y[n-1]
$$

其中：

$$
b_0 = \frac{1}{1 + \frac{\omega_c T}{2}}
$$

$$
b_1 = b_0
$$

$$
a_1 = \frac{1 - \frac{\omega_c T}{2}}{1 + \frac{\omega_c T}{2}}
$$

通过这些参数的推导，我们可以得到一阶IIR低通滤波器的系数，这样就可以在数字信号处理中实现所需的滤波效果。这些步骤同样适用于其他类型的一阶IIR滤波器（如高通、带通和带阻滤波器），只是设计目标和规范会有所不同。

# 二阶IIR滤波器参数推导

二阶IIR（Infinite Impulse Response）滤波器是一种常见的数字滤波器，用于实现更复杂的频率响应。以下是推导二阶IIR滤波器参数的过程。

## 1. 数字滤波器的差分方程

二阶IIR滤波器的差分方程通常表示为：

$$
y[n] = b_0 x[n] + b_1 x[n-1] + b_2 x[n-2] - a_1 y[n-1] - a_2 y[n-2]
$$

其中：

- $y[n]$ 是当前输出
- $x[n]$ 是当前输入
- $b_0, b_1, b_2$ 是滤波器的前向系数
- $a_1, a_2$ 是滤波器的反馈系数

## 2. 频域分析

要推导这些系数，可以从滤波器的频率响应出发。数字滤波器的传递函数通常表示为：

$$
H(z) = \frac{Y(z)}{X(z)} = \frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}
$$

## 3. 模拟滤波器设计

假设我们要设计一个标准的二阶低通滤波器，模拟域中的传递函数可以表示为：

$$
H(s) = \frac{\omega_0^2}{s^2 + 2\zeta \omega_0 s + \omega_0^2}
$$

其中：

- $\omega_0$ 是滤波器的中心频率
- $\zeta$ 是阻尼系数，决定滤波器的带宽

## 4. 双线性变换

通过双线性变换将模拟滤波器转换为数字滤波器。双线性变换公式为：

$$
s = \frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}}
$$

将其代入模拟滤波器的传递函数：

$$
H\left( \frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}} \right) = \frac{\left( \frac{2}{T} \right)^2 \omega_0^2}{\left( \frac{2}{T} \right)^2 \left( \frac{1 - z^{-1}}{1 + z^{-1}} \right)^2 + 2\zeta \omega_0 \left( \frac{2}{T} \right) \left( \frac{1 - z^{-1}}{1 + z^{-1}} \right) + \omega_0^2}
$$

## 5. 简化表达式

简化并重新排列上式，可以得到：

$$
H(z) = \frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}
$$

通过比较系数，可以确定滤波器的系数：

$$
b_0 = \frac{\omega_0^2 T^2}{4 + 4\zeta \omega_0 T + \omega_0^2 T^2}
$$

$$
b_1 = \frac{2\omega_0^2 T^2}{4 + 4\zeta \omega_0 T + \omega_0^2 T^2}
$$

$$
b_2 = \frac{\omega_0^2 T^2}{4 + 4\zeta \omega_0 T + \omega_0^2 T^2}
$$

$$
a_1 = \frac{8 - 2\omega_0^2 T^2}{4 + 4\zeta \omega_0 T + \omega_0^2 T^2}
$$

$$
a_2 = \frac{4 - 4\zeta \omega_0 T + \omega_0^2 T^2}{4 + 4\zeta \omega_0 T + \omega_0^2 T^2}
$$

## 6. 参数具体化

将上面的公式化简，得到实际应用中的滤波器系数。

假设我们现在有二阶IIR滤波器的中心频率 $f_0$，采样率 $f_s$，增益 Gain 和 Q 值，下面是如何将这些参数换算为滤波器系数的过程。

### 1. 基本参数定义

- $f_0$：中心频率
- $f_s$：采样率
- $Q$：品质因数
- $A$：增益，线性尺度

### 2. 中心频率和品质因数

归一化角频率的推导来自于将模拟频率转换为数字频率的过程。设模拟域的中心频率为 $f_0$，采样率为 $f_s$。在离散时间域中，角频率为 $\omega = 2\pi f / f_s$。因此，中心频率 $f_0$ 对应的角频率 $\omega_0$ 为：

$$
\omega_0 = 2\pi \frac{f_0}{f_s}
$$

带宽参数 $\alpha$ 是基于归一化角频率 $\omega_0$ 和品质因数 $Q$ 计算得到的。

$\alpha$ 的推导来源于滤波器的频率响应特性。对于二阶IIR滤波器，带宽参数 $\alpha$ 的计算公式来源于双线性变换和品质因数 $Q$ 的定义。

品质因数 $Q$ 定义为：

$$
Q = \frac{f_0}{BW}
$$

其中，$BW$ 是带宽。带宽 $BW$ 可以表示为：

$$
BW = \frac{\omega_0}{2\alpha}
$$

通过解上述公式，我们可以得到 $\alpha$ 的表达式为：

$$
\alpha = \frac{\sin(\omega_0)}{2Q}
$$

这个公式表示了带宽参数 $\alpha$ 和归一化角频率 $\omega_0$ 以及品质因数 $Q$ 之间的关系。

计算归一化角频率 $\omega_0$ 和带宽参数 $\alpha$：

$$
\omega_0 = 2\pi \frac{f_0}{f_s}
$$

$$
\alpha = \sin(\omega_0) \frac{\sin(\omega_0)}{2Q}
$$

### 3. 计算滤波器系数

根据滤波器类型（低通、高通、带通、带阻等），计算相应的系数。以下以低通滤波器为例。

#### 低通滤波器

$$
b_0 = (1 - \cos(\omega_0))/2
$$

$$
b_1 = 1 - \cos(\omega_0)
$$

$$
b_2 = (1 - \cos(\omega_0))/2
$$

$$
a_0 = 1 + \alpha
$$

$$
a_1 = -2 \cos(\omega_0)
$$

$$
a_2 = 1 - \alpha
$$

#### 将系数归一化

将系数归一化，以便于实现：

$$
b_0' = \frac{b_0}{a_0}
$$

$$
b_1' = \frac{b_1}{a_0}
$$

$$
b_2' = \frac{b_2}{a_0}
$$

$$
a_1' = \frac{a_1}{a_0}
$$

$$
a_2' = \frac{a_2}{a_0}
$$

#### 4. 总结

将上述系数带入差分方程：

$$
y[n] = b_0' x[n] + b_1' x[n-1] + b_2' x[n-2] - a_1' y[n-1] - a_2' y[n-2]
$$

其中，$b_0'$、$b_1'$、$b_2'$ 是前向系数，$a_1'$、$a_2'$ 是反馈系数。

#### 示例

假设中心频率 $f_0 = 1000$ Hz，采样率 $f_s = 44100$ Hz，品质因数 $Q = 0.707$，增益 $A = 1$（线性增益为1，不影响计算）。计算出归一化角频率和带宽参数：

$$
\omega_0 = 2\pi \frac{1000}{44100} \approx 0.142
$$

$$
\alpha = \sin(0.142) \frac{\sin(0.142)}{2 \times 0.707} \approx 0.100
$$

计算滤波器系数并归一化：

$$
b_0 = \frac{1 - \cos(0.142)}{2} \approx 0.0041
$$

$$
b_1 = 1 - \cos(0.142) \approx 0.0082
$$

$$
b_2 = \frac{1 - \cos(0.142)}{2} \approx 0.0041
$$

$$
a_0 = 1 + 0.100 \approx 1.100
$$

$$
a_1 = -2 \cos(0.142) \approx -1.979
$$

$$
a_2 = 1 - 0.100 \approx 0.900
$$

归一化系数：

$$
b_0' = \frac{0.0041}{1.100} \approx 0.0037
$$

$$
b_1' = \frac{0.0082}{1.100} \approx 0.0075
$$

$$
b_2' = \frac{0.0041}{1.100} \approx 0.0037
$$

$$
a_1' = \frac{-1.979}{1.100} \approx -1.799
$$

$$
a_2' = \frac{0.900}{1.100} \approx 0.818
$$

所以，滤波器的差分方程为：

$$
y[n] = 0.0037 x[n] + 0.0075 x[n-1] + 0.0037 x[n-2] - 1.799 y[n-1] - 0.818 y[n-2]
$$

## 总结

二阶IIR滤波器的最终差分方程可以表示为：

$$
y[n] = b_0 x[n] + b_1 x[n-1] + b_2 x[n-2] - a_1 y[n-1] - a_2 y[n-2]
$$

通过这些参数的推导，我们可以得到二阶IIR滤波器的系数，这样就可以在数字信号处理中实现所需的滤波效果。这些步骤同样适用于其他类型的二阶IIR滤波器（如高通、带通和带阻滤波器），只是设计目标和规范会有所不同。