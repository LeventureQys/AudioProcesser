# 一阶FIR滤波器参数的推导

一阶FIR滤波器是一种简单的数字滤波器，其冲激响应在有限时间内消失。以下是推导一阶FIR滤波器参数的具体过程。

## 1. FIR滤波器的基本形式

FIR滤波器的差分方程表示为：

$$
y[n] = \sum_{k=0}^{N-1} b_k x[n-k]
$$

对于一阶FIR滤波器，其差分方程简化为：

$$
y[n] = b_0 x[n] + b_1 x[n-1]
$$

其中：

- $y[n]$ 是当前输出
- $x[n]$ 是当前输入
- $b_0, b_1$ 是滤波器的系数
- $N = 2$ 是滤波器的阶数

## 2. 设计规范

假设我们要设计一个简单的一阶低通FIR滤波器，给定以下参数：

- 截止频率 $f_c$
- 采样率 $f_s$

## 3. 理想低通滤波器的冲激响应

理想低通滤波器在频域中的定义是一个矩形频率响应函数，即在截止频率 $f_c$ 之内完全通过，而在 $f_c$ 之外完全阻断。

理想低通滤波器的冲激响应为：

$$
h_d[n] = \begin{cases}
\frac{\sin(2\pi f_c (n - \frac{1}{2}))}{\pi (n - \frac{1}{2})}, & n \neq \frac{1}{2} \\
2 f_c, & n = \frac{1}{2}
\end{cases}
$$

对于一阶滤波器，我们只有两个系数 $b_0$ 和 $b_1$，且 $n$ 只能取 $0$ 和 $1$：

$$
h_d[0] = \frac{\sin(2\pi f_c (0 - \frac{1}{2}))}{\pi (0 - \frac{1}{2})}
$$

$$
h_d[1] = \frac{\sin(2\pi f_c (1 - \frac{1}{2}))}{\pi (1 - \frac{1}{2})}
$$

## 4. 窗函数法设计FIR滤波器

为了在实际中使用，我们采用窗函数法来修正理想冲激响应。对于一阶FIR滤波器，我们使用简单的矩形窗：

$$
w[n] = 1, \quad n = 0, 1
$$

最终的FIR滤波器系数为：

$$
b[n] = h_d[n] \cdot w[n], \quad n = 0, 1
$$

## 5. 参数具体化

将上述公式具体化，得到实际应用中的滤波器系数。例如：

- 采样率 $f_s = 8000$ Hz
- 截止频率 $f_c = 1000$ Hz

归一化截止频率：

$$
f_c = \frac{1000}{8000} = 0.125
$$

计算理想低通滤波器的冲激响应：

$$
h_d[0] = \frac{\sin(2\pi \cdot 0.125 \cdot (0 - 0.5))}{\pi (0 - 0.5)} = \frac{\sin(-0.125\pi)}{-0.5\pi} = \frac{-\sin(0.125\pi)}{-0.5\pi} = \frac{\sin(0.125\pi)}{0.5\pi}
$$

$$
h_d[1] = \frac{\sin(2\pi \cdot 0.125 \cdot (1 - 0.5))}{\pi (1 - 0.5)} = \frac{\sin(0.125\pi)}{0.5\pi}
$$

因为 $w[n] = 1$，所以最终的FIR滤波器系数为：

$$
b_0 = h_d[0] = \frac{\sin(0.125\pi)}{0.5\pi}
$$

$$
b_1 = h_d[1] = \frac{\sin(0.125\pi)}{0.5\pi}
$$

### 简化

$$
b_0 = b_1 = \frac{\sin(0.125\pi)}{0.5\pi}
$$

## 总结

通过上述步骤，我们可以计算出一阶FIR滤波器的系数：

$$
y[n] = b_0 x[n] + b_1 x[n-1]
$$

其中：

$$
b_0 = b_1 = \frac{\sin(0.125\pi)}{0.5\pi}
$$

通过这些参数的推导，我们可以得到一阶FIR滤波器的系数，从而在数字信号处理中实现所需的滤波效果。

# 二阶FIR滤波器参数的推导

FIR（Finite Impulse Response）滤波器是一种常见的数字滤波器，其冲激响应在有限时间内消失。以下是推导二阶FIR滤波器参数的具体过程。

## 1. FIR滤波器的基本形式

FIR滤波器的差分方程表示为：

$$
y[n] = \sum_{k=0}^{N-1} b_k x[n-k]
$$

对于二阶FIR滤波器，其差分方程简化为：

$$
y[n] = b_0 x[n] + b_1 x[n-1] + b_2 x[n-2]
$$

其中：

- $y[n]$ 是当前输出
- $x[n]$ 是当前输入
- $b_0, $b_1, $b_2$ 是滤波器的系数
- $N = 3$ 是滤波器的阶数

## 2. 设计规范

假设我们要设计一个简单的二阶低通FIR滤波器，给定以下参数：

- 截止频率 $f_c$
- 采样率 $f_s$

## 3. 理想低通滤波器的冲激响应

理想低通滤波器的冲激响应 \( h_d[n] \) 的推导可以通过频域到时域的逆傅里叶变换来理解。

### 理想低通滤波器的频域定义

理想低通滤波器在频域的定义为：

$$
H_d(e^{j\omega}) = \begin{cases}
1, & |\omega| \leq \omega_c \\
0, & \text{otherwise}
\end{cases}
$$

其中，$\omega_c$ 是截止频率。

### 频域到时域的逆傅里叶变换

为了找到理想低通滤波器的时域冲激响应 \( h_d[n] \)，需要对频域函数 \( H_d(e^{j\omega}) \) 进行逆傅里叶变换：

$$
h_d[n] = \frac{1}{2\pi} \int_{-\pi}^{\pi} H_d(e^{j\omega}) e^{j\omega n} d\omega
$$

根据 $H_d(e^{j\omega})$ 的定义，上述积分可以简化为在 $-\omega_c$到 $\omega_c$ 之间：

$$
h_d[n] = \frac{1}{2\pi} \int_{-\omega_c}^{\omega_c} e^{j\omega n} d\omega
$$

### 计算积分

$$
h_d[n] = \frac{1}{2\pi} \left[ \frac{e^{j\omega n}}{jn} \right]_{-\omega_c}^{\omega_c} = \frac{1}{2\pi} \left( \frac{e^{j\omega_c n} - e^{-j\omega_c n}}{jn} \right)
$$

利用欧拉公式 $e^{j\theta} - e^{-j\theta} = 2j \sin(\theta)$，上式变为：

$$
h_d[n] = \frac{1}{2\pi} \left( \frac{2j \sin(\omega_c n)}{jn} \right) = \frac{\sin(\omega_c n)}{\pi n}
$$

### 引入归一化

将频率 $\omega_c$ 用归一化频率 $f_c = \frac{\omega_c}{2\pi}$ 表示：

$$
h_d[n] = \frac{\sin(2\pi f_c n)}{\pi n}
$$

### 处理 $n = \frac {N-1} {2}$

由于滤波器长度为 \( N \)，滤波器是一个对称的偶数长度的 FIR 滤波器，我们通常将其中心对齐在 \( n = \frac{N-1}{2} \) 处。因此，对 \( n \) 进行平移：

$$
h_d[n] = \frac{\sin(2\pi f_c (n - \frac{N-1}{2}))}{\pi (n - \frac{N-1}{2})}
$$

在$n = \frac{N-1}{2}$ 处，这个表达式的分母变为零，因此需要单独处理。我们可以使用极限来处理这个情况：

$$
h_d\left[\frac{N-1}{2}\right] = \lim_{n \to \frac{N-1}{2}} \frac{\sin(2\pi f_c (n - \frac{N-1}{2}))}{\pi (n - \frac{N-1}{2})}
$$

利用极限 $\lim_{x \to 0} \frac{\sin(x)}{x} = 1$，得到：

$$
h_d\left[\frac{N-1}{2}\right] = 2 f_c
$$

理想低通滤波器的冲激响应为：

$$
h_d[n] = \begin{cases}
\frac{\sin(2\pi f_c (n - \frac{N-1}{2}))}{\pi (n - \frac{N-1}{2})}, & n \neq \frac{N-1}{2} \\
2 f_c, & n = \frac{N-1}{2}
\end{cases}
$$

这是通过对频域函数进行逆傅里叶变换，并在中心位置使用极限处理的结果。

对于二阶滤波器，我们有三个系数 $b_0$、$b_1$ 和 $b_2$，且 $n$ 取 $0$、$1$ 和 $2$：

$$
h_d[0] = \frac{\sin(2\pi f_c (0 - 1))}{\pi (0 - 1)} = \frac{\sin(-2\pi f_c)}{-\pi} = \frac{\sin(2\pi f_c)}{\pi}
$$

$$
h_d[1] = \frac{\sin(2\pi f_c (1 - 1))}{\pi (1 - 1)} = 2 f_c
$$

$$
h_d[2] = \frac{\sin(2\pi f_c (2 - 1))}{\pi (2 - 1)} = \frac{\sin(2\pi f_c)}{\pi}
$$

## 4. 窗函数法设计FIR滤波器

为了在实际中使用，我们采用窗函数法来修正理想冲激响应。对于二阶FIR滤波器，我们使用简单的矩形窗：

$$
w[n] = 1, \quad n = 0, 1, 2
$$

最终的FIR滤波器系数为：

$$
b[n] = h_d[n] \cdot w[n], \quad n = 0, 1, 2
$$

## 5. 参数具体化

将上述公式具体化，得到实际应用中的滤波器系数。例如：

- 采样率 $f_s = 8000$ Hz
- 截止频率 $f_c = 1000$ Hz

归一化截止频率：

$$
f_c' = \frac{1000}{8000} = 0.125
$$

计算理想低通滤波器的冲激响应：

$$
h_d[0] = \frac{\sin(2\pi \cdot 0.125 \cdot (0 - 1))}{\pi (0 - 1)} = \frac{\sin(-0.25\pi)}{-\pi} = \frac{-\sin(0.25\pi)}{-\pi} = \frac{\sin(0.25\pi)}{\pi}
$$

$$
h_d[1] = 2 \cdot 0.125 = 0.25
$$

$$
h_d[2] = \frac{\sin(2\pi \cdot 0.125 \cdot (2 - 1))}{\pi (2 - 1)} = \frac{\sin(0.25\pi)}{\pi}
$$

因为 $w[n] = 1$，所以最终的FIR滤波器系数为：

$$
b_0 = \frac{\sin(0.25\pi)}{\pi}
$$

$$
b_1 = 0.25
$$

$$
b_2 = \frac{\sin(0.25\pi)}{\pi}
$$

### 简化

$$
b_0 = b_2 = \frac{\sin(0.25\pi)}{\pi}
$$

## 总结

通过上述步骤，我们可以计算出二阶FIR滤波器的系数：

$$
y[n] = b_0 x[n] + b_1 x[n-1] + b_2 x[n-2]
$$

其中：

$$
b_0 = b_2 = \frac{\sin(0.25\pi)}{\pi}
$$

$$
b_1 = 0.25
$$

通过这些参数的推导，我们可以得到二阶FIR滤波器的系数，从而在数字信号处理中实现所需的滤波效果。

## FIR滤波器设计一个Peaking类型滤波器

### 1. 定义滤波器参数

假设我们有以下参数：

- 中心频率 $f_0$（单位：赫兹）
- 采样率 $f_s$（单位：赫兹）
- 增益 $G$（单位：分贝）
- Q值 $Q$（无单位）
- 滤波器长度 $N$（必须为偶数）

### 2. 计算归一化频率

归一化中心频率：

$$
f_0' = \frac{f_0}{f_s}
$$

### 3. 计算带宽

带宽 $BW$ 和 Q值的关系为：

$$
BW = \frac{f_0}{Q}
$$

归一化带宽：

$$
BW' = \frac{BW}{f_s} = \frac{f_0}{Q f_s}
$$

### 4. 计算理想脉冲响应

理想的峰值滤波器的频率响应可以表示为一个带通滤波器的组合。以下是计算理想脉冲响应的方法：

设定滤波器的归一化中心频率和带宽为：

$$
\omega_0 = 2\pi f_0'
$$

$$
\Delta \omega = 2\pi BW'
$$

理想的脉冲响应为：

$$
h[n] = \frac{\sin(\omega_2 (n - \frac{N-1}{2}))}{\pi (n - \frac{N-1}{2})} - \frac{\sin(\omega_1 (n - \frac{N-1}{2}))}{\pi (n - \frac{N-1}{2})}
$$

其中：

$$
\omega_1 = \omega_0 - \frac{\Delta \omega}{2}
$$

$$
\omega_2 = \omega_0 + \frac{\Delta \omega}{2}
$$

### 5. 应用窗口函数

为了得到实际的FIR滤波器系数，通常需要应用一个窗口函数（如汉宁窗口、汉明窗口等）来截取脉冲响应。假设我们使用汉明窗口：

$$
w[n] = 0.54 - 0.46 \cos\left( \frac{2\pi n}{N-1} \right)
$$

最终的滤波器系数为：

$$
h_{final}[n] = h[n] \cdot w[n]
$$

### 6. 增益调整

将增益 $G$ 转换为线性标度：

$$
A = 10^{\frac{G}{20}}
$$

调整滤波器系数以实现所需的增益：

$$
h_{final}[n] = A \cdot h_{final}[n]
$$

### 总结

通过上述步骤，我们可以设计一个带有特定中心频率、采样率、增益和Q值的Peaking类型FIR滤波器。具体实现过程中，可以使用Matlab、Python等工具进行计算和验证。