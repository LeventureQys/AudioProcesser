# FIR滤波器在低频下曲线符合度不够的原因

## 频率分辨率的影响

FIR滤波器的频率分辨率由滤波器长度 $N$ 和采样率 $f_s$ 决定：

$$
\Delta f = \frac{f_s}{N}
$$

假设采样率 $f_s = 10000$ Hz，滤波器长度 $N = 100$，则频率分辨率为：

$$
\Delta f = \frac{10000}{100} = 100 \text{ Hz}
$$

这意味着滤波器在频域上只能分辨出100 Hz的频率间隔。对于非常低的频率（如10 Hz），这种频率分辨率是不足够的，因为10 Hz的信号细节被100 Hz的分辨率所掩盖。

## 滤波器设计与窗函数效应

### 理想滤波器的冲激响应

理想的低通滤波器在频域上的频率响应是一个矩形窗函数，截止频率为 $f_c$：

$$
H_d(e^{j\omega}) = \begin{cases}
1, & |\omega| \leq \omega_c \\
0, & \text{otherwise}
\end{cases}
$$

通过逆傅里叶变换，可以得到理想的时域冲激响应：

$$
h_d[n] = \frac{\sin(2\pi f_c (n - \frac{N-1}{2}))}{\pi (n - \frac{N-1}{2})}
$$

### 实际滤波器的冲激响应

由于实际滤波器是有限长度的，我们需要使用窗函数来截断理想的无限长冲激响应。假设使用Hamming窗，窗函数定义为：

$$
w[n] = 0.54 - 0.46 \cos\left( \frac{2\pi n}{N-1} \right)
$$

实际滤波器的冲激响应为：

$$
h[n] = h_d[n] \cdot w[n] = \frac{\sin(2\pi f_c (n - \frac{N-1}{2}))}{\pi (n - \frac{N-1}{2})} \cdot \left( 0.54 - 0.46 \cos\left( \frac{2\pi n}{N-1} \right) \right)
$$

### 频率响应的计算

实际滤波器的频率响应 $H(e^{j\omega})$ 是其冲激响应 $h[n]$ 的离散时间傅里叶变换（DTFT）：

$$
H(e^{j\omega}) = \sum_{n=0}^{N-1} h[n] e^{-j\omega n}
$$

由于窗函数的作用，滤波器的频率响应不再是一个理想的矩形，而是引入了旁瓣效应（sidelobes），这些旁瓣会在频域上产生泄漏，导致频率响应偏离理想情况。

## 低频部分的分析

在低频部分，理想低通滤波器的频率响应应该是平坦的，表示所有低于截止频率的频率成分都能完全通过。然而，实际FIR滤波器由于频率分辨率和窗函数的影响，其低频部分的频率响应往往不够平坦。

### 频率分辨率的影响

由于频率分辨率 $\Delta f = 100$ Hz，滤波器对低频（如10 Hz）信号的区分能力不足，导致低频部分的响应不精确。

### 窗函数效应

窗函数的使用引入了旁瓣效应，使得滤波器的频率响应在低频部分出现波动，无法保持理想的平坦度。

### 数学推导

为了具体说明这种现象，我们考虑实际滤波器频率响应的频域表达式：

$$
H(e^{j\omega}) = \sum_{n=0}^{N-1} \left( \frac{\sin(2\pi f_c (n - \frac{N-1}{2}))}{\pi (n - \frac{N-1}{2})} \cdot \left( 0.54 - 0.46 \cos\left( \frac{2\pi n}{N-1} \right) \right) \right) e^{-j\omega n}
$$

低频部分的频率响应可以表示为：

$$
H(e^{j\omega}) \approx H(e^{j\omega}) \bigg|_{\omega \approx 0}
$$

由于旁瓣效应和频率分辨率的限制，低频部分的响应出现波动和不平坦。这种波动主要是由于窗函数引入的频域泄漏导致的，频域泄漏会在频率响应曲线上产生周期性的波动。

## 总结

FIR滤波器在低频下曲线符合度不够的原因主要是由于频率分辨率的限制和窗函数引入的旁瓣效应。具体表现为：

- 频率分辨率不足导致低频信号的细节无法准确处理。
- 窗函数引入的旁瓣效应导致频率响应在低频部分出现波动，无法保持理想的平坦度。

通过增加滤波器长度 $N$、选择合适的窗函数、优化滤波器设计参数，可以在一定程度上改善FIR滤波器在低频部分的表现，但仍无法完全达到理想滤波器的效果。